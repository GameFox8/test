# Задача Pyhon – анализ успешности сотрудников

## Задача
Есть N файлов excel в папке. В файлах лежит информация о планах работы и сотрудниках участвующих в проектах. 

Колонки:
* Название проекта
* Руководитель – сотрудник ответственный за проект
* Дата сдачи (план и факт) – планируемая и фактическая дата сдачи проекта
* Список сотрудников (план и факт) – сколько человеко-дней каждого сотрудника потрачено на проект по плану и по факту.

Сотрудников и проектов может быть сколько угодно в каждом файле. В каждом файле полезная информация лежит только на первом листе.
Необходимо по этим файлам оценить успешность сотрудников. Критерий для успешности выбрать самому.
Сделать вывод списка сотрудников в порядке их успешности по выбранному критерию.

## Описание решения
В качестве _критерия_ оценки успешности сотрудника было выбрано среднее квадратическое отклонение человеко-дней потраченных по факту от планируемого количества, что покажет на сколько в среднем сотрудник отклонялся от планируемых ему человеко-дней.

Для тестирования программы был написан скрипт **employee_gen.py**, который случайным образом, считывая из файла **FIO_re.txt** список фамилий, создавал нужную для анализа информацию и сохранял в excel файлы, которые в дальнейшем парсились

**Порядок действий:**
1. Парсинг данных из excel файлов, находящихся (в данном случае) в каталоге "employees", в базу данных (PostgreSQL)
2. С помощью запроса, используя встроенные агрегатные функций PostgreSQL, выводится нужная статистика о сотрудниках
3. Представление полученных данных пользователю 

## Ожидаемые результаты работы программы

При запуске срипта **main.py** и готовой для работы базе данных в консоли должен появиться список сотрудников, сортированный по убыванию успешности. 
Пример: ![screenshot of sample](https://sun9-23.userapi.com/c204724/v204724015/60485/Na9w_-cRVSo.jpg)

## Описание архитектуры проекта
Для работы с базой данных создан класс **Postgre**, находящийся в модуле **DbProjects**, который содержит в себе ряд необходимых функций для реализации поставленной задачи, в нем описана вся логика работы с БД. Также, для удобства, функция, реализующая парсинг, **parse_projects** была вынесена в модуль **ExcelParser**. Все эти модули находятся в пакете **src**, и используются в **main.py** (точка входа). Папка **employees** содержит excel файлы, в которых храниться информация о планах работы и сотрудниках участвующих в проектах.   

## Дальнейшие перспективы по расширению функционала
Какой функционал можно добавить к задаче:
* Выводить список успешности сотрудников за определнный период
* Добавить возможность сравнивать сотрудников по разным критериям успешности
* Производить вероятностную оценку сдачи проета в определенный срок
* Формировать наиболее успешные команды для проектов
* Подбирать подходящих руководителей

Все это можно реализовать используя: статистику, математический анализ и другие разделы математики.

## Используемые библиотеки
* **openpyxl** - для работы с excel фалами. (<https://openpyxl.readthedocs.io/en/stable/>)
* **sycopg2** - для работы PostgreSQL. (<https://github.com/psycopg/psycopg2>)
